<div class="container" novalidate>
	<header color="primary">
		<h2>New Order</h2>
	</header>
	
	<mat-error *ngIf="feedback" class="alert alert-{{feedback.type}}">{{feedback.message}}</mat-error>
	
	<form [formGroup]="orderForm" (ngSubmit)="onSubmit()">
		<!-- TODO add better styles for radio group -->
		<div class="mat-form-field radio-group-form-field">
			<label id="orderType-label">Order Type</label>
			<!-- TODO disable orderType while editing -->
			<mat-radio-group aria-labelledby="orderType-label" class="radio-group" formControlName="orderType" (change)="onOrderTypeChange($event)" [disabled]="isEditing"> 
				<mat-radio-button class="radio-button" value="Coat">Coat</mat-radio-button> 
				<mat-radio-button class="radio-button" value="Regular">Regular</mat-radio-button> 
			</mat-radio-group>
		</div>
		<div>
			<mat-form-field appearance="outline" class="date-form-field"> 
				<mat-label>Order Date</mat-label>
				<input matInput formControlName="orderDate" [matDatepicker]="orderDatepicker" [disabled]="isEditing">
				<mat-datepicker-toggle matSuffix [for]="orderDatepicker" [disabled]="isEditing"></mat-datepicker-toggle>
			    <mat-datepicker #orderDatepicker></mat-datepicker>
			</mat-form-field>
		</div>
		<div>
			<mat-form-field appearance="outline" class="date-form-field"> 
				<mat-label>Delivery Date</mat-label>
				<input matInput [min]="orderForm.value.orderDate" formControlName="deliveryDate" [matDatepicker]="deliveryDatepicker">
				<mat-datepicker-toggle matSuffix [for]="deliveryDatepicker"></mat-datepicker-toggle>
			    <mat-datepicker #deliveryDatepicker></mat-datepicker>
			</mat-form-field>
		</div>
		<div>
			<mat-form-field appearance="outline">
				<mat-label>Order Number</mat-label> 
				<input matInput formControlName="orderNumber">
			</mat-form-field>
		</div>
		<div>
			<mat-form-field appearance="outline">
				<mat-label>Name</mat-label>
				<input matInput formControlName="name">
			</mat-form-field>
		</div>
		<div>
			<mat-form-field appearance="outline">
				<mat-label>Mobile</mat-label>
				<input matInput formControlName="mobile">
			</mat-form-field>
		</div>
		<div>
			<mat-form-field appearance="outline">
				<mat-label>Items</mat-label>
    			<mat-select formControlName="itemNames" multiple (selectionChange)="onItemSelectionChange($event)">
					<mat-optgroup *ngFor="let group of selectItemGroupsArray" [label]="group.name" [disabled]="group.disabled">
	      				<mat-option *ngFor="let item of group.selectItems" [value]="item.viewValue" [disabled]="group.disabled">{{item.viewValue}}</mat-option>
	    			</mat-optgroup>
				</mat-select>
			</mat-form-field>
		</div>
		<div formArrayName="itemCounts">
			<div *ngFor="let item of itemCounts.controls; let i=index">
				<mat-form-field appearance="outline" class="item-form-field">
					<mat-label>{{orderForm.value.itemNames[i]}}</mat-label> 
					<input matInput [formControlName]="i">
				</mat-form-field>
			</div>
		</div>
		<div>
			<mat-form-field hintLabel="Max 300 characters" appearance="outline">
				<mat-label>Notes</mat-label>
    			<textarea matInput #notesInput maxlength="300" formControlName="notes"></textarea>
    			<mat-hint align="end">{{notesInput.value?.length || 0}}/300</mat-hint>
  			</mat-form-field>
		</div>
		<div>
			<button mat-raised-button color="primary" type="submit" class="button" [disabled]="!orderForm.valid">Submit</button>
			<span class="space-5px"></span>
			<button mat-raised-button color="secondary" type="button" (click)="onCancel()">Cancel</button>
		</div>
		<!-- <p>Order form values: {{ orderForm.value | json }}</p>
		<p>Order form isValid: {{ orderForm.valid }}</p> -->
	</form>
</div>
